<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Contagem de Duelos</title>
</head>
<body>

<textarea id="entrada" rows="20" cols="80" placeholder="Cole aqui o texto..."></textarea>
<br><br>
<button onclick="contarDuelo()">Contar Duelo</button>
<p id="saida"></p>
<div id="detalhes" style="white-space:pre-wrap; font-family:monospace;"></div>

<script>
function contarDuelo() {
  const texto = document.getElementById('entrada').value;
  const linhas = texto.split('\n').map(l => l.trim()).filter(l => l);

  const resultado = [];
  const nomesComp = [];
  let count = 0;
  let compAtual = null;

  const compRe = /(Brasileir[aã]o.*Série\s*[ABCD]|Brasileir[aã]o.*Fem\.?|Camp\.\s*Brasileiro.*Fem\.?|Premier\s*League|La\s*Liga|Serie\s*A|Serie\s*B|Bundesliga|Ligue\s*1|Ligue\s*2|Copa|Libertadores|Sul-?Americana)/i;
  const headerRe = /(Casa|Emp|Fora)/i;
  const oddsRe = /^\d+[,.]\d+/;
  const dataRe = /\d{1,2}\/[a-z]{3}|\d{1,2}:\d{2}/i;

  const isCompeticao = l => compRe.test(l);

  const isTime = l => {
    if (isCompeticao(l)) return false;
    if (headerRe.test(l)) return false;
    if (oddsRe.test(l)) return false;
    if (dataRe.test(l)) return false;
    if (/^[+*]/.test(l)) return false;
    if (/^\d+$/.test(l)) return false;
    return true;
  };

  for (let i = 0; i < linhas.length; i++) {
    const linha = linhas[i];

    if (isCompeticao(linha)) {
      // fecha a competição anterior
      if (compAtual !== null) {
        resultado.push(count);
        nomesComp.push(compAtual);
      }
      compAtual = linha;
      count = 0;
      continue;
    }

    if (isTime(linha) && isTime(linhas[i+1])) {
      count++;
      i++; // pula a próxima linha (já usada no duelo)
    }
  }

  // fecha a última competição
  if (compAtual !== null) {
    resultado.push(count);
    nomesComp.push(compAtual);
  }

  // saída
  document.getElementById('saida').innerText =
    'Contagem de duelos: [' + resultado.join(', ') + ']';

  const detalhe = nomesComp.map((n, i) => `${n}: ${resultado[i]} duelos`).join('\n');
  document.getElementById('detalhes').innerText = detalhe;
}
</script>

</body>
</html>
